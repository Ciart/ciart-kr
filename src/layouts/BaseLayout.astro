---
import 'galmuri/dist/galmuri.css';
import '../styles/global.css';

import Header from '../components/Header.astro';

type Props = {
    title?: string;
    isDarkMode?: boolean;
}

const { title, isDarkMode } = Astro.props;
---

<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    <title>{title ? `${title} - Ciart` : 'Ciart'}</title>
  </head>
  <body class="font-pixel flex flex-col items-center bg-ciart w-full min-h-[calc(100svh+6rem)]">
    <nav class="max-lg:container lg:w-5xl mx-auto absolute z-50">
      <Header isDarkMode={isDarkMode} />
    </nav>
    <div id="a" class="bg-white w-full flex-1 corner-smooth">
      <main
        class="mt-header-height max-lg:container lg:w-5xl mx-auto px-4 text-black/85 w-full"
      >
        <slot />
      </main>
    </div>
    <footer class="h-24"></footer>
  </body>
</html>

<style>
  html,
  body {
    margin: 0;
  }
</style>

<script>
const main = document.querySelector<HTMLDivElement>('#a');
    const footer = document.querySelector<HTMLElement>('footer');

    if (main && footer) {
      const footerRect = footer.getBoundingClientRect();
      const windowHeight = window.innerHeight;
      
      if (footerRect.top <= windowHeight) {
        const progress = windowHeight - footerRect.top;
        main.style.borderRadius = progress / 96 * 64 + 'px';
      } else {
        main.style.borderRadius = '0px';
      }
    }

  window.addEventListener('scroll', () => {
    const main = document.querySelector<HTMLDivElement>('#a');
    const footer = document.querySelector<HTMLElement>('footer');

    if (main && footer) {
      const footerRect = footer.getBoundingClientRect();
      const windowHeight = window.innerHeight;
      
      if (footerRect.top <= windowHeight) {
        const progress = windowHeight - footerRect.top;
        main.style.borderRadius = `calc(${progress / 96 * 32}px * var(--brm))`;
      } else {
        main.style.borderRadius = '0px';
      }
    }
  });
</script>
